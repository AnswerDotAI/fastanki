# Core API


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
user = os.environ['ANKI_USER']
passw = os.environ['ANKI_PASS']
```

## OO API

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L30"
target="_blank" style="float:right; font-size:smaller">source</a>

### data_path

``` python

def data_path(
    
):

```

*Return the default Anki data folder for this OS.*

``` python
data_path()
```

    Path('/Users/racheltho/Library/Application Support/Anki2')

``` python
data_path().ls()
```

    [Path('/Users/racheltho/Library/Application Support/Anki2/User 1')]

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L39"
target="_blank" style="float:right; font-size:smaller">source</a>

### profiles

``` python

def profiles(
    
):

```

*List available Anki profile names.*

``` python
profiles()
```

    ['User 1']

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L54"
target="_blank" style="float:right; font-size:smaller">source</a>

### Collection.open

``` python

def open(
    profile:NoneType=None
):

```

*Open a collection by profile name (creates if needed).*

Class method to open a collection by profile name. Handles backend
reuse, creates profile folder if needed, and stores `profile_path` for
auth persistence.

``` python
col = Collection.open()
col.profile_path
```

    Path('/Users/racheltho/Library/Application Support/Anki2/User 1')

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L76"
target="_blank" style="float:right; font-size:smaller">source</a>

### Collection.load_auth

``` python

def load_auth(
    
):

```

*Load SyncAuth from profile folder, or None if not found.*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L71"
target="_blank" style="float:right; font-size:smaller">source</a>

### Collection.save_auth

``` python

def save_auth(
    auth
):

```

*Persist SyncAuth to profile folder.*

Auth persistence methods: `save_auth` writes the `SyncAuth` protobuf to
disk, `load_auth` reads it back. The endpoint is crucial â€” AnkiWeb may
redirect you to a different sync server.

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L86"
target="_blank" style="float:right; font-size:smaller">source</a>

### Collection.sync

``` python

def sync(
    user:NoneType=None, passw:NoneType=None, media:bool=True, upload:bool=False
):

```

``` python
note = col.newNote()
note.fields[0] = "Test card front"
note.fields[1] = "Test card back"
col.addNote(note)
```

    1

``` python
result = col.sync(user=user, passw=passw)
result
```

    required: NORMAL_SYNC

Full sync implementation: loads saved auth (or logs in), handles
endpoint changes, re-authenticates on failure, and manages full
upload/download when required.

``` python
# First sync requires credentials
col.sync(user=user, passw=passw)

# Subsequent syncs use saved auth
col.sync()
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L118"
target="_blank" style="float:right; font-size:smaller">source</a>

### close_all

``` python

def close_all(
    
):

```

*Close all open Anki backends (nuclear option for crash recovery).*

Nuclear option for crash recovery â€” scans all Python objects to find and
close any open Rust backends.

``` python
col.models
```

- Basic
- Basic (and reversed card)
- Basic (optional reversed card)
- Basic (type in the answer)
- Cloze
- Image Occlusion

Markdown representations for decks. `DeckManager` lists deck names,
`DeckNameId` shows name/id, `DeckTreeNode` shows name with due counts.

``` python
col.sched.deck_due_tree().children[0]
```

**Default**: 11 new, 0 learn, 5 review

``` python
col.decks
```

- Default
- Precalculus

Enables dict-style access: `col.models['Basic']` returns the model dict,
`col.decks['Default']` returns the deck id.

``` python
mdl = col.models['Basic']
mdl['id']
```

    1764652425113

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L153"
target="_blank" style="float:right; font-size:smaller">source</a>

### Note.\_\_repr\_\_

``` python

def __repr__(
    
):

```

*Return repr(self).*

``` python
note = col.new_note(mdl)
note['Front'], note['Back'] = 'hola', 'hello'
note
```

**Front**: hola | **Back**: hello

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L162"
target="_blank" style="float:right; font-size:smaller">source</a>

### Deck

``` python

def Deck(
    col, name
):

```

*Initialize self. See help(type(self)) for accurate signature.*

Wrapper class for a deck with convenient `.add()`, `.due`
(new/learn/review counts), and `.cards` (list of card ids).

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L181"
target="_blank" style="float:right; font-size:smaller">source</a>

### DeckManager.\_\_getitem\_\_

``` python

def __getitem__(
    name
):

```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L185"
target="_blank" style="float:right; font-size:smaller">source</a>

### Collection.add

``` python

def add(
    model:NoneType=None, deck:NoneType=None, tags:NoneType=None, fields:VAR_KEYWORD
):

```

*Add a note with the given fields.*

Convenient method to add a note with keyword arguments for fields.
Defaults to Basic model and Default deck.

``` python
note2 = col.add(Front='hola', Back='hello', tags=['spanish'])
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L197"
target="_blank" style="float:right; font-size:smaller">source</a>

### Collection.add_deck

``` python

def add_deck(
    name
):

```

*Create a deck (use :: for nesting).*

Creates a new deck. Use `::` for nested decks (e.g.Â `"Spanish::Vocab"`
creates Vocab inside Spanish).

``` python
col.add_deck('Spanish::Vocab')
```

    changes {
      deck: true
      browser_table: true
      browser_sidebar: true
      study_queues: true
      mtime: true
    }
    id: 1772224367444

``` python
deck = col.decks['Spanish::Vocab']
deck.add(Front='adiÃ³s', Back='goodbye')
deck.due
```

**Vocab**: 1 new, 0 learn, 0 review

``` python
col.remove_notes([note2.id])
```

âœ“ 1 change(s)

``` python
col.decks.remove([col.decks.id_for_name('Spanish')])
```

âœ“ 1 change(s)

``` python
col.sync()
```

**Sync**: NO_CHANGES

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L225"
target="_blank" style="float:right; font-size:smaller">source</a>

### Deck.\_\_repr\_\_

``` python

def __repr__(
    
):

```

*Return repr(self).*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L222"
target="_blank" style="float:right; font-size:smaller">source</a>

### Card.\_\_repr\_\_

``` python

def __repr__(
    
):

```

*Return repr(self).*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L219"
target="_blank" style="float:right; font-size:smaller">source</a>

### OpChangesWithCount.\_\_repr\_\_

``` python

def __repr__(
    
):

```

*Return repr(self).*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L215"
target="_blank" style="float:right; font-size:smaller">source</a>

### DeckTreeNode.\_\_repr\_\_

``` python

def __repr__(
    
):

```

*Return repr(self).*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L212"
target="_blank" style="float:right; font-size:smaller">source</a>

### DeckNameId.\_\_repr\_\_

``` python

def __repr__(
    
):

```

*Return repr(self).*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L209"
target="_blank" style="float:right; font-size:smaller">source</a>

### DeckManager.\_\_repr\_\_

``` python

def __repr__(
    
):

```

*Return repr(self).*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L206"
target="_blank" style="float:right; font-size:smaller">source</a>

### NotetypeNameId.\_\_repr\_\_

``` python

def __repr__(
    
):

```

*Return repr(self).*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L203"
target="_blank" style="float:right; font-size:smaller">source</a>

### ModelManager.\_\_repr\_\_

``` python

def __repr__(
    
):

```

*Return repr(self).*

``` python
col.close()
```

## Functional API

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L232"
target="_blank" style="float:right; font-size:smaller">source</a>

### Collection.\_\_exit\_\_

``` python

def __exit__(
    args:VAR_POSITIONAL
):

```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L229"
target="_blank" style="float:right; font-size:smaller">source</a>

### Collection.\_\_enter\_\_

``` python

def __enter__(
    
):

```

You can use `Collection` with Pythonâ€™s `with` statement. This ensures
the collection is always properly closed, even if an error occurs during
your operations. No more orphaned database locks or forgotten cleanup
calls.

``` python
with Collection.open() as col: note = col.add(Front='hola', Back='hello')
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L235"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_card

``` python

def add_card(
    profile:NoneType=None, model:NoneType=None, deck:NoneType=None, tags:NoneType=None, fields:VAR_KEYWORD
):

```

*Add a card.*

[`add_card`](https://AnswerDotAI.github.io/fastanki/core.html#add_card)
lets you create a new card with a single function call. Just pass your
field values as keyword arguments. By default it uses the Basic note
type and Default deck, but you can specify any model, deck, or tags you
like.

``` python
notezh = add_card(Front='ä½ å¥½', Back='hello')
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L241"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_fb_card

``` python

def add_fb_card(
    front:str, back:str, profile:str=None, model:str=None, deck:str=None, tags:str=None
):

```

*Add a card with a `Front` and `Back` and return the id.*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L246"
target="_blank" style="float:right; font-size:smaller">source</a>

### find_cards

``` python

def find_cards(
    query:str, profile:str=None
):

```

*Find cards matching query string. Returns list of Note objects.*

[`find_cards`](https://AnswerDotAI.github.io/fastanki/core.html#find_cards)
searches your collection and returns a list of `Card` objects. Pass any
Anki search query as the first argument. Common query patterns: -
`deck:Spanish` â€” cards in a specific deck - `tag:vocab` â€” cards with a
tag - `front:hello` â€” match field content - `is:due` â€” cards due for
review - `added:7` â€” added in the last 7 days

Combine with spaces (AND) or `OR`: `deck:Spanish tag:verb` finds Spanish
cards tagged â€œverbâ€.

``` python
cards = find_cards("deck:Default")
cards
```

    [Card(1769220553306, nid=1769220312702, due=5, ivl=0, queue=0),
     Card(1771131052669, nid=1771131052669, due=12, ivl=0, queue=0),
     Card(1771131140690, nid=1771131140690, due=13, ivl=0, queue=0),
     Card(1771298205236, nid=1771298205236, due=14, ivl=0, queue=0),
     Card(1771994857427, nid=1771994857425, due=15, ivl=0, queue=0),
     Card(1771994862491, nid=1771994862491, due=18, ivl=0, queue=0),
     Card(1771994864613, nid=1771994864613, due=19, ivl=0, queue=0),
     Card(1771995456598, nid=1771995456598, due=22, ivl=0, queue=0),
     Card(1772223814874, nid=1772223814873, due=23, ivl=0, queue=0),
     Card(1772224020120, nid=1772224020120, due=24, ivl=0, queue=0),
     Card(1772224365000, nid=1772224365000, due=25, ivl=0, queue=0),
     Card(1772224370021, nid=1772224370021, due=28, ivl=0, queue=0),
     Card(1772224372112, nid=1772224372112, due=29, ivl=0, queue=0),
     Card(1772224372153, nid=1772224372153, due=30, ivl=0, queue=0),
     Card(1768961835197, nid=1768961835196, due=55, ivl=4, queue=2),
     Card(1769219943743, nid=1769219943743, due=57, ivl=3, queue=2),
     Card(1769144854211, nid=1769144854210, due=58, ivl=4, queue=2),
     Card(1769220066429, nid=1769220066429, due=59, ivl=5, queue=2),
     Card(1769220312702, nid=1769220312702, due=59, ivl=5, queue=2)]

``` python
cards[0]
```

Card 1769220553306 (nid: 1769220312702, due: 5, ivl: 0d, queue: 0)

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L257"
target="_blank" style="float:right; font-size:smaller">source</a>

### find_card_ids

``` python

def find_card_ids(
    query:str, profile:str=None
):

```

*Find card ids matching query string.*

``` python
find_card_ids("deck:Default")
```

    [1769220553306, 1771131052669, 1771131140690, 1771298205236, 1771994857427, 1771994862491, 1771994864613, 1771995456598, 1772223814874, 1772224020120, 1772224365000, 1772224370021, 1772224372112, 1772224372153, 1768961835197, 1769219943743, 1769144854211, 1769220066429, 1769220312702]

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L263"
target="_blank" style="float:right; font-size:smaller">source</a>

### find_notes

``` python

def find_notes(
    query:str, profile:str=None
):

```

*Find notes matching query string. Returns list of Note objects.*

[`find_notes`](https://AnswerDotAI.github.io/fastanki/core.html#find_notes)
searches your collection and returns a list of `Note` objects (rather
than `Card` objects). The query language is the same as
[`find_cards`](https://AnswerDotAI.github.io/fastanki/core.html#find_cards)
â€” all the same search patterns work. The difference is that
[`find_notes`](https://AnswerDotAI.github.io/fastanki/core.html#find_notes)
returns one result per note, while
[`find_cards`](https://AnswerDotAI.github.io/fastanki/core.html#find_cards)
may return multiple cards if a note generates more than one card (e.g.,
with Cloze or Basic-and-Reversed note types).

``` python
notes = find_notes("hello")
notes
```

    [Note(1771994864613, Front='hola', Back='hello', tags=[]),
     Note(1772224372112, Front='hola', Back='hello', tags=[]),
     Note(1772224372153, Front='ä½ å¥½', Back='hello', tags=[])]

``` python
note = notes[0]
note
```

**Front**: hola | **Back**: hello

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L269"
target="_blank" style="float:right; font-size:smaller">source</a>

### find_note_ids

``` python

def find_note_ids(
    query:str, profile:str=None
):

```

*Find note ids matching query string.*

``` python
find_note_ids("hello")
```

    [1771994864613, 1772224372112, 1772224372153]

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L275"
target="_blank" style="float:right; font-size:smaller">source</a>

### update_note

``` python

def update_note(
    note:int, profile:str=None, tags:str=None, add_tags:str=None, fields:VAR_KEYWORD
):

```

*Update an existing noteâ€™s fields and/or tags. Pass a Note object or
note ID.*

[`update_note`](https://AnswerDotAI.github.io/fastanki/core.html#update_note)
modifies an existing noteâ€™s fields and/or tags. Pass either a `Note`
object or a note ID, along with any fields you want to change as keyword
arguments. For tags: - `tags=['a','b']` â€” replaces all tags -
`add_tags='newtag'` â€” adds without removing existing tags

``` python
update_note(note, Back="updated answer", tags='testtag')
```

**Front**: hola | **Back**: updated answer | ğŸ·ï¸ testtag

``` python
update_note(note, add_tags='moretagz')
```

**Front**: hola | **Back**: updated answer | ğŸ·ï¸ moretagz, testtag

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L287"
target="_blank" style="float:right; font-size:smaller">source</a>

### update_fb_note

``` python

def update_fb_note(
    note_id:int, front:str='', back:str='', profile:str=None, tags:str=None, add_tags:str=None
):

```

*Update an existing noteâ€™s front/back fields and/or tags. Pass a Note
object or note ID.*

``` python
update_fb_note(note, front='I am new')
```

**Front**: I am new | **Back**: updated answer | ğŸ·ï¸ moretagz, testtag

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L295"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_note

``` python

def get_note(
    note_id:int, profile:str=None
):

```

*Retrieve a note by ID.*

``` python
get_note(note.id)
```

**Front**: I am new | **Back**: updated answer | ğŸ·ï¸ moretagz, testtag

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L301"
target="_blank" style="float:right; font-size:smaller">source</a>

### del_card

``` python

def del_card(
    notes:int, profile:str=None
):

```

*Delete card(s) by Note(s) or note id(s).*

``` python
del_card([notezh, note])
```

âœ“ 2 change(s)

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L308"
target="_blank" style="float:right; font-size:smaller">source</a>

### sync

``` python

def sync(
    profile:str=None, user:str=None, passw:str=None, media:bool=True
):

```

*Sync collection, handling open/close automatically.*

[`sync`](https://AnswerDotAI.github.io/fastanki/core.html#sync) handles
the entire sync lifecycle for you â€” opening the collection,
authenticating with AnkiWeb, syncing, and closing up afterwards. The
first time you sync, pass your AnkiWeb credentials; theyâ€™ll be saved for
future use.

``` python
o = sync(user=user, passw=passw) # First time
# sync()  # after that
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L314"
target="_blank" style="float:right; font-size:smaller">source</a>

### anki_tools

``` python

def anki_tools(
    
):

```

Adding cloze cards

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastanki/blob/main/fastanki/core.py#L317"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_cloze_card

``` python

def add_cloze_card(
    text, deck:str='Default', tags:NoneType=None, back_extra:str=''
):

```

*Add a cloze deletion card.*

``` python
test_cloze = add_cloze_card("Minus times {{c1::minus}} is always {{c2::plus}}", back_extra="Proof. Let â€“ğ‘ and â€“ğ‘ represent any two negative numbers. Then (âˆ’ğ‘)(âˆ’ğ‘)=(âˆ’1)(ğ‘)(âˆ’1)(ğ‘)=ğ‘ğ‘(âˆ’1)(âˆ’1)=ğ‘ğ‘.")
```

``` python
get_note(test_cloze)
```

**Text**: Minus times {{c1::minus}} is always {{c2::plus}} | **Back
Extra**: Proof. Let â€“ğ‘ and â€“ğ‘ represent any two negative numbers. Then
(âˆ’ğ‘)(âˆ’ğ‘)=(âˆ’1)(ğ‘)(âˆ’1)(ğ‘)=ğ‘ğ‘(âˆ’1)(âˆ’1)=ğ‘ğ‘.

``` python
update_note(test_cloze, add_tags='precalculus')
```

**Text**: Minus times {{c1::minus}} is always {{c2::plus}} | **Back
Extra**: Proof. Let â€“ğ‘ and â€“ğ‘ represent any two negative numbers. Then
(âˆ’ğ‘)(âˆ’ğ‘)=(âˆ’1)(ğ‘)(âˆ’1)(ğ‘)=ğ‘ğ‘(âˆ’1)(âˆ’1)=ğ‘ğ‘. | ğŸ·ï¸ precalculus

``` python
get_note(test_cloze)
```

**Text**: Minus times {{c1::minus}} is always {{c2::plus}} | **Back
Extra**: Proof. Let â€“ğ‘ and â€“ğ‘ represent any two negative numbers. Then
(âˆ’ğ‘)(âˆ’ğ‘)=(âˆ’1)(ğ‘)(âˆ’1)(ğ‘)=ğ‘ğ‘(âˆ’1)(âˆ’1)=ğ‘ğ‘. | ğŸ·ï¸ precalculus

``` python
del_card(test_cloze)
```

âœ“ 2 change(s)
